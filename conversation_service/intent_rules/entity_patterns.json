{
  "version": "1.0",
  "last_updated": "2025-01-30",
  "description": "Patterns d'extraction et normalisation des entités financières",
  "entity_types": {
    "amount": {
      "description": "Montants monétaires et valeurs numériques",
      "priority": 1,
      "patterns": [
        {
          "regex": "\\b(\\d+(?:[,.]\\d+)?)\\s*(?:euros?|€|EUR)\\b",
          "case_sensitive": false,
          "extract_group": 1,
          "normalize": "float",
          "weight": 1.0
        },
        {
          "regex": "\\b(\\d+)\\s*(?:€|EUR)\\b",
          "case_sensitive": false,
          "extract_group": 1,
          "normalize": "float",
          "weight": 1.0
        },
        {
          "regex": "\\b(\\d+(?:[,.]\\d+)?)\\s*(?:dollars?|\\$|USD)\\b",
          "case_sensitive": false,
          "extract_group": 1,
          "normalize": "float",
          "currency": "USD",
          "weight": 0.9
        },
        {
          "regex": "\\b(\\d+(?:[,.]\\d+)?)\\s*(?:livres?|£|GBP)\\b",
          "case_sensitive": false,
          "extract_group": 1,
          "normalize": "float", 
          "currency": "GBP",
          "weight": 0.9
        }
      ],
      "exact_values": {
        "cent euros": {"value": 100.0, "currency": "EUR"},
        "mille euros": {"value": 1000.0, "currency": "EUR"},
        "cinquante euros": {"value": 50.0, "currency": "EUR"},
        "vingt euros": {"value": 20.0, "currency": "EUR"},
        "dix euros": {"value": 10.0, "currency": "EUR"},
        "cinq euros": {"value": 5.0, "currency": "EUR"}
      },
      "operators": {
        "plus de": "gt",
        "supérieur à": "gt", 
        "au-dessus de": "gt",
        "moins de": "lt",
        "inférieur à": "lt",
        "en dessous de": "lt",
        "exactement": "eq",
        "égal à": "eq",
        "entre": "range"
      }
    },

    "period": {
      "description": "Périodes temporelles et dates",
      "priority": 2,
      "patterns": [
        {
          "regex": "\\b(ce\\s+mois|mois\\s+en\\s+cours|mois\\s+actuel)\\b",
          "case_sensitive": false,
          "extract_group": 0,
          "normalize": "current_month",
          "weight": 1.0
        },
        {
          "regex": "\\b(mois\\s+dernier|dernier\\s+mois|mois\\s+précédent)\\b",
          "case_sensitive": false,
          "extract_group": 0,
          "normalize": "last_month",
          "weight": 1.0
        },
        {
          "regex": "\\b(cette\\s+semaine|semaine\\s+en\\s+cours|semaine\\s+actuelle)\\b",
          "case_sensitive": false,
          "extract_group": 0,
          "normalize": "current_week",
          "weight": 1.0
        },
        {
          "regex": "\\b(semaine\\s+dernière|dernière\\s+semaine|semaine\\s+précédente)\\b",
          "case_sensitive": false,
          "extract_group": 0,
          "normalize": "last_week",
          "weight": 1.0
        },
        {
          "regex": "\\b(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)\\b",
          "case_sensitive": false,
          "extract_group": 0,
          "normalize": "month_name",
          "weight": 0.9
        },
        {
          "regex": "\\b(hier|avant-hier)\\b",
          "case_sensitive": false,
          "extract_group": 0,
          "normalize": "relative_day",
          "weight": 0.8
        },
        {
          "regex": "\\b(\\d{4})\\b",
          "case_sensitive": false,
          "extract_group": 1,
          "normalize": "year",
          "weight": 0.7
        },
        {
          "regex": "\\b(\\d{1,2})/(\\d{1,2})/(\\d{4})\\b",
          "case_sensitive": false,
          "extract_groups": [1, 2, 3],
          "normalize": "date_format",
          "weight": 0.95
        }
      ],
      "exact_values": {
        "ce mois": "current_month",
        "mois dernier": "last_month", 
        "cette semaine": "current_week",
        "semaine dernière": "last_week",
        "aujourd'hui": "today",
        "hier": "yesterday",
        "avant-hier": "day_before_yesterday",
        "cette année": "current_year",
        "année dernière": "last_year"
      },
      "month_mappings": {
        "janvier": {"month": 1, "name": "janvier"},
        "février": {"month": 2, "name": "février"},
        "mars": {"month": 3, "name": "mars"},
        "avril": {"month": 4, "name": "avril"},
        "mai": {"month": 5, "name": "mai"},
        "juin": {"month": 6, "name": "juin"},
        "juillet": {"month": 7, "name": "juillet"},
        "août": {"month": 8, "name": "août"},
        "septembre": {"month": 9, "name": "septembre"},
        "octobre": {"month": 10, "name": "octobre"},
        "novembre": {"month": 11, "name": "novembre"},
        "décembre": {"month": 12, "name": "décembre"}
      }
    },

    "category": {
      "description": "Catégories de dépenses et types de transactions",
      "priority": 3,
      "patterns": [
        {
          "regex": "\\b(restaurant|resto|repas|dîner|déjeuner|manger|restauration)\\b",
          "case_sensitive": false,
          "normalize": "restaurant",
          "weight": 1.0
        },
        {
          "regex": "\\b(courses|alimentation|supermarché|épicerie|nourriture|alimentaire)\\b",
          "case_sensitive": false,
          "normalize": "alimentation",
          "weight": 1.0
        },
        {
          "regex": "\\b(transport|essence|carburant|taxi|métro|bus|train|voiture)\\b",
          "case_sensitive": false,
          "normalize": "transport",
          "weight": 1.0
        },
        {
          "regex": "\\b(santé|pharmacie|médecin|dentiste|hôpital|clinique|médicaments?)\\b",
          "case_sensitive": false,
          "normalize": "santé",
          "weight": 1.0
        },
        {
          "regex": "\\b(shopping|vêtements?|habits?|chaussures?|mode|textile)\\b",
          "case_sensitive": false,
          "normalize": "shopping",
          "weight": 1.0
        },
        {
          "regex": "\\b(loisirs?|cinéma|sport|gym|divertissement|spectacle)\\b",
          "case_sensitive": false,
          "normalize": "loisirs",
          "weight": 1.0
        },
        {
          "regex": "\\b(logement|loyer|charges|électricité|gaz|eau)\\b",
          "case_sensitive": false,
          "normalize": "logement",
          "weight": 1.0
        },
        {
          "regex": "\\b(éducation|école|formation|livre|fournitures?)\\b",
          "case_sensitive": false,
          "normalize": "éducation",
          "weight": 1.0
        }
      ],
      "exact_values": {
        "restaurant": "restaurant",
        "resto": "restaurant",
        "repas": "restaurant",
        "restauration": "restaurant",
        "courses": "alimentation",
        "supermarché": "alimentation",
        "alimentation": "alimentation",
        "épicerie": "alimentation",
        "transport": "transport",
        "essence": "transport",
        "carburant": "transport",
        "taxi": "transport",
        "santé": "santé",
        "pharmacie": "santé",
        "médecin": "santé",
        "shopping": "shopping",
        "vêtements": "shopping",
        "mode": "shopping",
        "loisirs": "loisirs",
        "cinéma": "loisirs",
        "sport": "loisirs",
        "logement": "logement",
        "loyer": "logement"
      },
      "category_hierarchy": {
        "restaurant": {
          "parent": "alimentation_sortie",
          "subcategories": ["fast_food", "restaurant_traditionnel", "livraison"]
        },
        "alimentation": {
          "parent": "dépenses_courantes",
          "subcategories": ["supermarché", "marché", "bio"]
        },
        "transport": {
          "parent": "dépenses_courantes", 
          "subcategories": ["carburant", "transport_public", "taxi_uber"]
        },
        "santé": {
          "parent": "dépenses_essentielles",
          "subcategories": ["pharmacie", "médecin", "dentiste", "optique"]
        },
        "shopping": {
          "parent": "dépenses_plaisir",
          "subcategories": ["vêtements", "chaussures", "accessoires"]
        },
        "loisirs": {
          "parent": "dépenses_plaisir",
          "subcategories": ["sport", "cinéma", "sorties", "hobbies"]
        }
      }
    },

    "merchant": {
      "description": "Noms de marchands et enseignes",
      "priority": 4,
      "patterns": [
        {
          "regex": "\\b(amazon)\\b",
          "case_sensitive": false,
          "normalize": "AMAZON",
          "weight": 1.0
        },
        {
          "regex": "\\b(netflix)\\b",
          "case_sensitive": false,
          "normalize": "NETFLIX",
          "weight": 1.0
        },
        {
          "regex": "\\b(carrefour)\\b",
          "case_sensitive": false,
          "normalize": "CARREFOUR",
          "weight": 1.0
        },
        {
          "regex": "\\b(uber)\\b",
          "case_sensitive": false,
          "normalize": "UBER",
          "weight": 1.0
        },
        {
          "regex": "\\b(sncf)\\b",
          "case_sensitive": false,
          "normalize": "SNCF",
          "weight": 1.0
        },
        {
          "regex": "\\b(mcdo|mcdonald|mcdonald's)\\b",
          "case_sensitive": false,
          "normalize": "MCDONALD'S",
          "weight": 1.0
        },
        {
          "regex": "\\b(spotify)\\b",
          "case_sensitive": false,
          "normalize": "SPOTIFY",
          "weight": 1.0
        },
        {
          "regex": "\\b(apple)\\b",
          "case_sensitive": false,
          "normalize": "APPLE",
          "weight": 0.9
        },
        {
          "regex": "\\b(google)\\b",
          "case_sensitive": false,
          "normalize": "GOOGLE",
          "weight": 0.9
        }
      ],
      "exact_values": {
        "amazon": "AMAZON",
        "netflix": "NETFLIX",
        "carrefour": "CARREFOUR",
        "leclerc": "LECLERC",
        "uber": "UBER",
        "sncf": "SNCF",
        "mcdo": "MCDONALD'S",
        "mcdonald": "MCDONALD'S",
        "spotify": "SPOTIFY",
        "apple": "APPLE",
        "google": "GOOGLE",
        "microsoft": "MICROSOFT",
        "paypal": "PAYPAL"
      },
      "merchant_categories": {
        "AMAZON": "shopping",
        "NETFLIX": "loisirs",
        "SPOTIFY": "loisirs",
        "CARREFOUR": "alimentation",
        "LECLERC": "alimentation",
        "UBER": "transport",
        "SNCF": "transport",
        "MCDONALD'S": "restaurant",
        "APPLE": "technologie",
        "GOOGLE": "technologie"
      }
    },

    "operation_type": {
      "description": "Types d'opérations bancaires",
      "priority": 5,
      "patterns": [
        {
          "regex": "\\b(carte|paiement\\s+carte|cb|carte\\s+bleue|card)\\b",
          "case_sensitive": false,
          "normalize": "card",
          "weight": 1.0
        },
        {
          "regex": "\\b(virement|virements?|transfer)\\b",
          "case_sensitive": false,
          "normalize": "transfer",
          "weight": 1.0
        },
        {
          "regex": "\\b(prélèvement|prélèvements?|direct\\s+debit)\\b",
          "case_sensitive": false,
          "normalize": "direct_debit",
          "weight": 1.0
        },
        {
          "regex": "\\b(chèque|chèques?|check)\\b",
          "case_sensitive": false,
          "normalize": "check",
          "weight": 1.0
        },
        {
          "regex": "\\b(retrait|retraits?|distributeur|dab|withdrawal)\\b",
          "case_sensitive": false,
          "normalize": "withdrawal",
          "weight": 1.0
        },
        {
          "regex": "\\b(dépôt|dépôts?|versement|deposit)\\b",
          "case_sensitive": false,
          "normalize": "deposit",
          "weight": 1.0
        }
      ],
      "exact_values": {
        "carte": "card",
        "cb": "card",
        "carte bleue": "card",
        "paiement carte": "card",
        "virement": "transfer",
        "virements": "transfer",
        "prélèvement": "direct_debit",
        "prélèvements": "direct_debit",
        "chèque": "check",
        "chèques": "check",
        "retrait": "withdrawal",
        "retraits": "withdrawal",
        "distributeur": "withdrawal",
        "dab": "withdrawal",
        "dépôt": "deposit",
        "versement": "deposit"
      },
      "operation_descriptions": {
        "card": "Paiement par carte bancaire",
        "transfer": "Virement bancaire",
        "direct_debit": "Prélèvement automatique",
        "check": "Paiement par chèque",
        "withdrawal": "Retrait d'espèces",
        "deposit": "Dépôt ou versement"
      }
    },

    "transaction_type": {
      "description": "Type de transaction (débit/crédit)",
      "priority": 6,
      "patterns": [
        {
          "regex": "\\b(dépense|dépenses?|sortie|sorties?|débit)\\b",
          "case_sensitive": false,
          "normalize": "debit",
          "weight": 1.0
        },
        {
          "regex": "\\b(recette|recettes?|entrée|entrées?|crédit|revenus?)\\b",
          "case_sensitive": false,
          "normalize": "credit", 
          "weight": 1.0
        }
      ],
      "exact_values": {
        "dépense": "debit",
        "dépenses": "debit",
        "sortie": "debit",
        "sorties": "debit",
        "débit": "debit",
        "recette": "credit",
        "recettes": "credit",
        "entrée": "credit",
        "entrées": "credit",
        "crédit": "credit",
        "revenus": "credit"
      }
    },

    "currency": {
      "description": "Devises et codes monétaires",
      "priority": 7,
      "patterns": [
        {
          "regex": "\\b(euros?|€|EUR)\\b",
          "case_sensitive": false,
          "normalize": "EUR",
          "weight": 1.0
        },
        {
          "regex": "\\b(dollars?|\\$|USD)\\b",
          "case_sensitive": false,
          "normalize": "USD",
          "weight": 1.0
        },
        {
          "regex": "\\b(livres?|£|GBP)\\b",
          "case_sensitive": false,
          "normalize": "GBP",
          "weight": 1.0
        }
      ],
      "exact_values": {
        "euro": "EUR",
        "euros": "EUR",
        "€": "EUR",
        "EUR": "EUR",
        "dollar": "USD",
        "dollars": "USD",
        "$": "USD",
        "USD": "USD",
        "livre": "GBP",
        "livres": "GBP",
        "£": "GBP",
        "GBP": "GBP"
      },
      "default_currency": "EUR"
    }
  },

  "global_settings": {
    "extraction_priorities": [
      "amount",
      "period", 
      "category",
      "merchant",
      "operation_type",
      "transaction_type",
      "currency"
    ],
    "normalization_rules": {
      "case_sensitive": false,
      "remove_accents": false,
      "trim_whitespace": true,
      "standardize_separators": true
    },
    "confidence_thresholds": {
      "high_confidence": 0.9,
      "medium_confidence": 0.7,
      "low_confidence": 0.5
    },
    "entity_validation": {
      "validate_amounts": true,
      "validate_dates": true,
      "validate_merchants": false,
      "validate_categories": true
    }
  }
}