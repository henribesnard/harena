{"openapi":"3.1.0","info":{"title":"conversation_service_v3","description":"\n    Conversation Service v3 - Architecture avec Agents LangChain Autonomes\n\n    ## Nouveautés v3:\n    - **Agents autonomes**: Chaque agent (Analyzer, Builder, Generator) utilise LangChain\n    - **Auto-correction**: Correction automatique des queries Elasticsearch en cas d'erreur\n    - **Connaissance du schéma**: Les agents comprennent la structure Elasticsearch\n    - **Pipeline optimisé**: Agrégations + résumé + 50 premières transactions\n\n    ## Pipeline:\n    1. **QueryAnalyzerAgent**: Analyse la question et extrait les entités\n    2. **ElasticsearchBuilderAgent**: Traduit en query Elasticsearch valide\n    3. **Exécution**: Appel à search_service avec retry + correction\n    4. **ResponseGeneratorAgent**: Génère une réponse naturelle avec insights\n\n    ## Auto-correction:\n    - Si la query échoue, l'agent ElasticsearchBuilder analyse l'erreur\n    - Il génère une query corrigée automatiquement\n    - Maximum 2 tentatives de correction\n    ","version":"3.0.0"},"paths":{"/api/v3/conversation/ask":{"post":{"tags":["conversation"],"summary":"Ask Question","description":"Pose une question sur les transactions financières\n\nLe pipeline complet avec agents autonomes:\n1. Analyse la question (QueryAnalyzerAgent)\n2. Construit la query Elasticsearch (ElasticsearchBuilderAgent)\n3. Exécute la query sur search_service\n4. Auto-correction si échec\n5. Génère la réponse (ResponseGeneratorAgent)\n\nReturns:\n    Réponse conversationnelle avec résultats et insights","operationId":"ask_question_api_v3_conversation_ask_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationResponseModel"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v3/conversation/stats":{"get":{"tags":["conversation"],"summary":"Get Stats","description":"Récupère les statistiques de l'orchestrateur et des agents\n\nReturns:\n    Statistiques détaillées incluant:\n    - Taux de succès\n    - Taux de correction\n    - Performance des agents","operationId":"get_stats_api_v3_conversation_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Stats Api V3 Conversation Stats Get"}}}}}}},"/api/v3/conversation/health":{"get":{"tags":["conversation"],"summary":"Health Check","description":"Health check de l'orchestrateur et des services\n\nReturns:\n    Status de santé des agents et services externes","operationId":"health_check_api_v3_conversation_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Health Check Api V3 Conversation Health Get"}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health","description":"Health check endpoint","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ConversationRequest":{"properties":{"user_id":{"type":"integer","title":"User Id"},"message":{"type":"string","title":"Message"},"conversation_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Conversation Id"},"context":{"items":{},"type":"array","title":"Context","default":[]}},"type":"object","required":["user_id","message"],"title":"ConversationRequest","description":"Requête de conversation"},"ConversationResponseModel":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"},"total_results":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Results"},"aggregations_summary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Aggregations Summary"},"metadata":{"type":"object","title":"Metadata","default":{}}},"type":"object","required":["success","message"],"title":"ConversationResponseModel","description":"Modèle de réponse de conversation"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}